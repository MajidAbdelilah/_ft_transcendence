events{
}
http {
server {
    listen 443 ssl;
    server_name 127.0.0.1;  # You can replace with your domain name if applicable

    ssl_certificate /etc/nginx/nginx.crt;  # Path to your SSL certificate
    ssl_certificate_key /etc/nginx/nginx.key;  # Path to your SSL certificate key

    # Backend Proxy Configuration
    location /api/ {
        proxy_pass http://backend:8000/;  # Forward requests to backend service on port 8000
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
    }

    # Frontend Proxy Configuration (React or Next.js app)
    location / {
        proxy_pass http://frontend:3000/;  # Forward requests to frontend service on port 3000
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
    }

    # Serve static files from the frontend (if needed)
    location /static/ {
        alias /var/www/frontend/.next/;  # If static assets are present in this folder
        expires 1y;
        access_log off;
    }

    # Serve static files for Next.js or React build (if you build your frontend statically)
    location /_next/static/ {
        alias /var/www/frontend/.next/static/;  # This is the path after running `next build`
        expires 1y;
        access_log off;
    }

    # Error page handling
    error_page 500 502 503 504 /50x.html;
    location = /50x.html {
        root /usr/share/nginx/html;
    }
}
}